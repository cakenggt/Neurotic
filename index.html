<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <script src="neurotic.js" charset="utf-8"></script>
    <script type="text/javascript">
      var n = new Neurotic(8,[8],8);
      var cont = true;
      var count = 0;
      var average = 0;
      var averageSq = 0;
      function anim(){
        document.getElementById('start').disabled = true;
        document.getElementById('stop').disabled = false;
        var data = eval(new Function(document.getElementById('testFunction').value))();
        if (count % 200 == 0){
          n.animate('canvas',data.input,data.output);
          document.getElementById('log').innerText += '\nAverage: ' + (average/200) + ' Average Diff: ' + (averageSq/200);
          average = 0;
          averageSq = 0;
          count = 0;
        }
        else{
          var results = n.query(data.input,data.output);
          average += results.correct;
          var sum = 0;
          for (var x = 0; x < 512; x++){
            if (results.result[x] == 1){
              sum ++;
            }
          }
          averageSq += Math.abs(sum - (data.outputVal));
        }
        if (cont){
          requestAnimationFrame(anim);
        }
        else{
          //stopping animation
          document.getElementById('start').disabled = false;
          document.getElementById('stop').disabled = true;
        }
        count++;
      }

      function query(){
        var result = n.query(JSON.parse(document.getElementById("queryValue").value));
        document.getElementById('queryResult').innerText = result.result;
        console.log(result);
      }

      function createNewNet(){
        var input = parseInt(document.getElementById('input').value);
        var hidden = JSON.parse(document.getElementById('hidden').value);
        var output = parseInt(document.getElementById('output').value);
        n = new Neurotic(input, hidden, output);
      }
    </script>
  </head>
  <body>
    <canvas id="canvas" style="width:1500px; height:500px;" width="1500" height="500"></canvas><br>
    Net Attributes:<br>
    Input Size: <input id="input" value="8"><br>
    Hidden Layers: <input id="hidden" value="[8]"><br>
    Output Size: <input id="output" value="8"><br>
    <button type="button" onclick="createNewNet()">Create New Net</button><hr>
    Test Function (must return map of format {input: [0,0,...,0], output: [0,0,...,0], outputVal: theValueOfTheOutput})<br>
    <textarea id="testFunction" rows="8" cols="80">
var query = [[10,10,10,10,0,0,0,0], [10,0,10,0,10,0,10,0]];
var resultVal = 1;
var choice = Math.floor(Math.random()*2);
return {input: query[choice], output: query[choice], outputVal: resultVal};
    </textarea><br>
    <button type="button" id="start" onclick="cont=true; anim();">start</button>
    <button type="button" id="stop" disabled=true onclick="cont=false;">stop</button><br>
    Log: <br><pre id="log"></pre><hr>
    Query string (must be an array in JSON parseable format)
    <input id="queryValue" value="[0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1]">
    <button type="button" id="query" onclick="query();">Query</button><br>
    Result: <pre id="queryResult"></pre>
  </body>
</html>
